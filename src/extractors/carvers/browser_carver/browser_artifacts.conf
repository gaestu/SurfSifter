# Browser Artifacts Carving Configuration
# For use with foremost and scalpel
# Part of Browser Forensics Phase 2 - Unallocated Browser Carving

# SQLite Database Files (Browser History, Cookies, Login Data, etc.)
# SQLite header: "SQLite format 3\x00"
# Maximum reasonable size for browser databases: 500MB
sqlite  y   500000000   \x53\x51\x4c\x69\x74\x65\x20\x66\x6f\x72\x6d\x61\x74\x20\x33\x00

# Chrome/Chromium Simple Cache Index
# Header magic: 0xC7 0x01 0xFE 0xAB (little-endian: 0xABFE01C7)
# Maximum size: 50MB
chridx  y   50000000    \xc7\x01\xfe\xab

# Chrome/Chromium Blockfile Cache Index
# Header magic: 0xC103CAC3 (little-endian)
# Maximum size: 50MB
chrblk  y   50000000    \xc3\xca\x03\xc1

# Firefox Cache2 Index
# Searches for cache2/index file marker
# Maximum size: 50MB  
ffcidx  y   50000000    \x00\x00\x00\x01\x00\x00\x00

# JSON Configuration Files (Chromium Preferences, etc.)
# Look for typical Chromium preferences patterns
# Maximum size: 50MB
# Note: JSON is hard to carve reliably, these are best-effort patterns

# LevelDB Log Files (.log)
# WARNING: DISABLED by default - the null-byte signature matches zeroed unallocated
# space, causing massive false positive carving (can fill disk with 75GB+ of junk).
# LevelDB files lack reliable magic bytes; use browser_storage extractor for
# live systems or specialized LevelDB recovery tools for deleted data.
# See: planning/done/browser_carver_ldblog_bloat.md
# ldblog  y   8000000   \x00\x00\x00\x00\x00\x00\x00\x00

# LevelDB Table Files (.ldb/.sst)
# LevelDB table magic (footer): 0x57FB808B (little-endian)
# Maximum size: 100MB
# Note: LevelDB files are complex, this catches partial tables

# SessionStorage/LocalStorage (LevelDB-based)
# Chromium uses LevelDB for web storage
# Covered by ldblog/ldbtbl patterns above

# Windows Jump List Files (*.automaticDestinations-ms, *.customDestinations-ms)
# OLE Compound Document header: D0 CF 11 E0 A1 B1 1A E1
# Maximum size: 50MB
ole     y   50000000    \xd0\xcf\x11\xe0\xa1\xb1\x1a\xe1

# LNK Shell Link Files
# LNK header: 4C 00 00 00 (CLSID follows)
# Maximum size: 64KB (typical LNK files are small)
lnk     y   65536       \x4c\x00\x00\x00\x01\x14\x02\x00

# Firefox Session Files (jsonlz4)
# Mozilla LZ4 compressed JSON: "mozLz40\x00"
# Maximum size: 50MB
mozlz4  y   50000000    \x6d\x6f\x7a\x4c\x7a\x34\x30\x00

# SNSS Session Files (Chromium)
# SNSS header: "SNSS" (0x53 0x4E 0x53 0x53)
# Maximum size: 50MB
snss    y   50000000    \x53\x4e\x53\x53
